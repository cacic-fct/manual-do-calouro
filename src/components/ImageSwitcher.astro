---
import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";

interface Props {
  lightSrc: string;
  darkSrc: string;
  divAttrs: astroHTML.JSX.HTMLAttributes;
  imageAttrs: astroHTML.JSX.ImgHTMLAttributes;
}

const { lightSrc, darkSrc, divAttrs, imageAttrs }: Props = Astro.props;

const images = import.meta.glob<{ default: ImageMetadata }>("/src/assets/*.{jpeg,jpg,png,gif,svg,webp,avif}");

if (!images[lightSrc]) {
  throw new Error(`"${lightSrc}" does not exist in glob: "src/assets/*.{jpeg,jpg,png,gif,svg,webp,avif}"`);
} else if (!images[darkSrc]) {
  throw new Error(`"${darkSrc}" does not exist in glob: "src/assets/*.{jpeg,jpg,png,gif,svg,webp,avif}"`);
}
---

<div {...divAttrs} class:list={{ "light:sl-hidden": Boolean(lightSrc) }}>
  <Image src={images[darkSrc]!()} alt={imageAttrs.alt || ""} />
</div>

<div {...divAttrs} class="dark:sl-hidden">
  <Image src={images[lightSrc]!()} alt={imageAttrs.alt || ""} />
</div>
